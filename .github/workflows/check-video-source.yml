name: Check Video Source

on:
  # 手动运行
  workflow_dispatch:

jobs:
  check-video:
    runs-on: ubuntu-latest  # 使用Ubuntu最新版本的虚拟机来运行工作

    steps:
    - name: Checkout repository
      uses: actions/checkout@v2  # 检出仓库代码

    - name: Set up Python
      uses: actions/setup-python@v2  # 设置Python环境
      with:
        python-version: 3.x  # 使用Python 3

    - name: Install dependencies
      run: |
        python -m pip install --upgrade pip
        pip install ffmpeg-python  # 如果需要的话，安装ffmpeg-python库

    - name: Check video source
      env:
        VIDEO_URL: "http://59.55.35.219:20000/hls/1/index.m3u8"  # 设置环境变量，这将传递给脚本
      run: |
        python check_video_source.py "$VIDEO_URL"  # 执行Python脚本并传递视频URL作为参数
